# Copyright 2004 OTP Systems Oy. All rights reserved.

# The reason why the JTux XA switch is not part of the JTux library is
# that, on Windows, the JTux XA switch needs to be passed to buildserver
# (and buildtms) in a separate object file. This way, the Microsoft VC++
# compiler will link the "__declspec(dllimport) xa_switch_t JTux_xa_switch"
# declaration in the stub code generated by buildserver to the locally
# defined JTux_xa_switch symbol in the JTux_xa_switch.obj object file.
# This will generate a warning in the process ("warning LNK4217: locally
# defined symbol JTux_xa_switch imported in function __tmgetsvrargs"),
# but this warning is harmless. If, on the other hand, the JTux_xa_switch
# is passed to buildserver as part of the JTux library then an error occurs
# ("error LNK2019: unresolved external symbol __imp__JTux_xa_switch
# referenced in function __tmgetsvrargs"). Apparently, the Microsoft VC++
# compiler treats a link library differently than a collection of object
# files.

BASE_DIR := ..

default: all

include $(BASE_DIR)/Makefile.include

all: $(JTuxXASwitch)

$(JTuxXASwitch): src/c/JTux_xa_switch.c
	-mkdir build
	cd build && $(call Compile,$(CFLAGS),../src/c/JTux_xa_switch.c)

clean:
	rm -rf build
